<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Formulario NAS v6</title>
  <link rel="stylesheet" href="assets/styles.css">
</head>
<body>
  <main class="container">
    <h1>Aplicación de la Escala NAS</h1>
    <p class="muted">Lista simple en el mismo orden de la tabla (1a → 23) con franjas alternadas.</p>

    <form id="nasForm">
      <section class="card">
        <h2>Datos de aplicación</h2>
        <div class="row">
          <label>Identificador (RUT u otro)
            <input type="text" name="identifier" placeholder="Opcional">
          </label>
          <label>Turno
            <select name="shift">
              <option value="Día">Día</option>
              <option value="Noche">Noche</option>
            </select>
          </label>
          <label>Fecha y hora de evaluación
            <input type="datetime-local" name="created_at">
          </label>
        </div>
        <label>Nota (opcional)
          <textarea name="note" rows="3" placeholder="Observaciones, procedimientos, etc."></textarea>
        </label>
      </section>

      <section class="card">
        <h2>Ítems NAS</h2>
        <div class="row">
          <label>Buscar ítem
            <input type="text" id="searchBox" placeholder="Filtrar por código o texto...">
          </label>
        </div>
        <div id="catalogGrid" class="grid zebra"></div>
        <div id="validationBox" class="warn" style="display:none;"></div>
      </section>

      <section class="card">
        <h2>Resumen</h2>
        <p><strong>Puntaje total:</strong> <span id="totalScore">0,0</span></p>
        <div class="row">
          <button type="submit">Guardar evaluación</button>
          <button type="button" id="dupLast">Duplicar última</button>
          <button type="button" id="printBtn">Imprimir</button>
        </div>
      </section>
    </form>

    <section class="card">
      <h2>Historial local (este navegador)</h2>
      <div id="history"></div>
      <button id="exportCsv">Exportar CSV</button>
    </section>

  </main>

  <script>
    window.NAS_CATALOG = {"1a": {"label": "Control de Signos Vitales por horario", "weight": 4.5}, "1b": {"label": "Observación continua o activa durante 2 horas o más", "weight": 12.1}, "1c": {"label": "Observación continua o activa 4 horas o más", "weight": 19.6}, "2": {"label": "Control de exámenes de laboratorio, bioquímicos y microbiológicos", "weight": 4.3}, "3": {"label": "Medicación excepto medicamentos vasoactivos", "weight": 5.6}, "4a": {"label": "Procedimientos de higiene básica", "weight": 4.1}, "4b": {"label": "Procedimientos de higiene con duración > 2 horas", "weight": 16.5}, "4c": {"label": "Procedimientos de higiene con duración > 4 horas", "weight": 20.0}, "5": {"label": "Cuidados de drenajes, excepto SNG", "weight": 1.8}, "6a": {"label": "Movilización y cambios de posición; sentar en sillón hasta 3 veces", "weight": 5.5}, "6b": {"label": "Movilización y cambios de posición; más de 3 veces/d o con 2 enfermeros", "weight": 12.4}, "6c": {"label": "Movilización y cambios de posición; con 3 o más enfermeras/os", "weight": 17.0}, "7a": {"label": "Apoyo y cuidado a familiares. Una hora de dedicación", "weight": 4.0}, "7b": {"label": "Apoyo y cuidado a familiares. Al menos tres horas de dedicación", "weight": 32.0}, "8a": {"label": "Tareas administrativas o de gestión: básicas", "weight": 4.2}, "8b": {"label": "Tareas administrativas o de gestión hasta 2 horas", "weight": 23.2}, "8c": {"label": "Tareas administrativas o de gestión más de 4 horas", "weight": 30.0}, "9": {"label": "Asistencia ventilatoria, cualquier forma", "weight": 1.4}, "10": {"label": "Cuidados de vía aérea artificial", "weight": 1.8}, "11": {"label": "Tratamientos para mejorar la función respiratoria", "weight": 4.4}, "12": {"label": "Medicación vasoactiva", "weight": 1.2}, "13": {"label": "Reposición intravenosa de gran cantidad de líquidos (>3 L por día)", "weight": 2.5}, "14": {"label": "Monitorización de aurícula izquierda (PICCO, Swan-Ganz, Vigileo, etc.)", "weight": 1.7}, "15": {"label": "RCP tras parada cardiorrespiratoria en las últimas 24 h", "weight": 7.1}, "16": {"label": "Técnicas de depuración extrarrenal (Diálisis, Novalung, etc.)", "weight": 7.7}, "17": {"label": "Cuantificación de diuresis", "weight": 7.0}, "18": {"label": "Medición de la presión intracraneal", "weight": 1.6}, "19": {"label": "Tratamiento de complicaciones metabólicas (acidosis/alcalosis)", "weight": 1.3}, "20": {"label": "Nutrición parenteral", "weight": 2.9}, "21": {"label": "Nutrición enteral", "weight": 1.3}, "22": {"label": "Intervenciones específicas en UCI (instalación CVC, PICC, etc.)", "weight": 2.8}, "23": {"label": "Intervenciones específicas fuera de la UCI (TAC, RNM, RX, etc.)", "weight": 1.9}};
    window.NAS_ORDER = ["1a", "1b", "1c", "2", "3", "4a", "4b", "4c", "5", "6a", "6b", "6c", "7a", "7b", "8a", "8b", "8c", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23"];
  </script>
  <script src="assets/app.js"></script>
</body>
</html>
